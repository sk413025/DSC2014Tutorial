<!DOCTYPE html>
<html>
<head>
  <title>ETL on R</title>
  <meta charset="utf-8">
  <meta name="description" content="ETL on R">
  <meta name="author" content="Cheng Yu Lin (aha) and Jia Wei Chen (jiawei)">
  <meta name="generator" content="slidify" />
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta http-equiv="X-UA-Compatible" content="chrome=1">
  <link rel="stylesheet" href="libraries/frameworks/io2012/css/default.css" media="all" >
  <link rel="stylesheet" href="libraries/frameworks/io2012/css/phone.css" 
    media="only screen and (max-device-width: 480px)" >
  <link rel="stylesheet" href="libraries/frameworks/io2012/css/slidify.css" >
  <link rel="stylesheet" href="libraries/highlighters/highlight.js/css/tomorrow.css" />
  <base target="_blank"> <!-- This amazingness opens all links in a new tab. -->  <link rel=stylesheet href="libraries/widgets/quiz/css/demo.css"></link>
<link rel=stylesheet href="libraries/widgets/bootstrap/css/bootstrap.css"></link>

  
  <!-- Grab CDN jQuery, fall back to local if offline -->
  <script src="http://ajax.aspnetcdn.com/ajax/jQuery/jquery-1.7.min.js"></script>
  <script>window.jQuery || document.write('<script src="libraries/widgets/quiz/js/jquery.js"><\/script>')</script> 
  <script data-main="libraries/frameworks/io2012/js/slides" 
    src="libraries/frameworks/io2012/js/require-1.0.8.min.js">
  </script>
  
  

</head>
<body style="opacity: 0">
  <slides class="layout-widescreen">
    
    <!-- LOGO SLIDE -->
        <slide class="title-slide segue nobackground">
  <hgroup class="auto-fadein">
    <h1>ETL on R</h1>
    <h2>非結構化資料處理</h2>
    <p>Cheng Yu Lin (aha) and Jia Wei Chen (jiawei)<br/></p>
  </hgroup>
  <article></article>  
  <footer class = 'license'>
    <a href='http://creativecommons.org/licenses/by-sa/3.0/'>
    <img width = '80px' src = 'http://mirrors.creativecommons.org/presskit/buttons/88x31/png/by-sa.png'>
    </a>
  </footer>
</slide>
    

    <!-- SLIDES -->
    <slide class="" id="slide-1" style="background:;">
  <article data-timings="">
    <p><q> 什麼是非結構化資料？ </q></p>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-2" style="background:;">
  <hgroup>
    <h2>結構化資料</h2>
  </hgroup>
  <article data-timings="">
    <p><img src = './resources/figures/structure_data.png' ></img></p>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-3" style="background:;">
  <hgroup>
    <h2>半結構化資料</h2>
  </hgroup>
  <article data-timings="">
    <p><img src = './resources/figures/semi_structure_data.png' ></img></p>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-4" style="background:;">
  <hgroup>
    <h2>非結構化資料</h2>
  </hgroup>
  <article data-timings="">
    <p><img src = './resources/figures/unstructure_data.png' ></img></p>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-5">
<hgroup>
  
</hgroup>
<article class = 'flexbox vcenter'>
<p><q> 非結構化資料可以整理出什麼訊息呢？ </q></p>

</article>
<!-- Presenter Notes -->
</slide>
<slide class="" id="slide-6" style="background:;">
  <article data-timings="">
    <p><img src = './resources/figures/keyword_analytics.png' ></img></p>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-7" style="background:;">
  <article data-timings="">
    <p><img src = './resources/figures/google_flu.png' ></img></p>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-8" style="background:;">
  <article data-timings="">
    <p><q> 我們這場 tutorial 要帶給大家什麼呢 ? </q></p>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-9" style="background:;">
  <hgroup>
    <h2>web scraping</h2>
  </hgroup>
  <article data-timings="">
    <p><img src = './resources/figures/html_pair.png' ></img></p>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-10">
<hgroup>
  
</hgroup>
<article class = 'flexbox vcenter'>
<p><img src = './resources/figures/result1.png' ></img></p>

</article>
<!-- Presenter Notes -->
</slide>
<slide class="" id="slide-11">
<hgroup>
  
</hgroup>
<article class = 'flexbox vcenter'>
<p><img src = './resources/figures/result2.png' ></img></p>

</article>
<!-- Presenter Notes -->
</slide>
<slide class="" id="slide-12" style="background:;">
  <hgroup>
    <h2>CH1 抓取網路資料</h2>
  </hgroup>
  <article data-timings="">
    
  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-13" style="background:;">
  <hgroup>
    <h2>What is HTML?</h2>
  </hgroup>
  <article data-timings="">
    <h3>一種有結構的標記資料</h3>

<p><img src = './resources/figures/html.png' ></img></p>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-14" style="background:;">
  <article data-timings="">
    <p><img src = './resources/figures/html_pair.png' ></img></p>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-15">
<hgroup>
  
</hgroup>
<article class = 'flexbox vcenter'>
<p><q> 其實它們是有結構的 </q></p>

</article>
<!-- Presenter Notes -->
</slide>
<slide class="" id="slide-16" style="background:;">
  <hgroup>
    <h2>Document Object Model (DOM)</h2>
  </hgroup>
  <article data-timings="">
    <h3>html 呈現樹狀結構</h3>

<p><img src = './resources/figures/dom.png' ></img></p>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-17" style="background:;">
  <hgroup>
    <h2>樹狀結構的內容</h2>
  </hgroup>
  <article data-timings="">
    <ol>
<li>nodename</li>
<li>attribute</li>
<li>text</li>
</ol>

<pre><code class="r">&lt;a href = &quot;www.meetup.com/Taiwan-R&quot;&gt;
  Taiwan R User Group Website
&lt;/a&gt;
</code></pre>

<pre><code class="r">nodename : a
attribute : href with value &quot;www.meetup.com/Taiwan-R&quot;
text: &quot;Taiwan R User Group Website&quot;
</code></pre>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-18" style="background:;">
  <hgroup>
    <h2>xpath 常用到的操作</h2>
  </hgroup>
  <article data-timings="">
    <ul>
<li><p>/ finds the root node</p></li>
<li><p>// selects from anywhere in the tree</p></li>
<li><p>&#39;.&#39; selects current node</p></li>
<li><p>&#39;..&#39; selects parent of current node</p></li>
<li><p>@ selects attributes</p></li>
</ul>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-19" style="background:;">
  <hgroup>
    <h2>如果想抓 a 的話</h2>
  </hgroup>
  <article data-timings="">
    <h3>we can use:</h3>

<pre><code class="r">&quot;/../body/div/a&quot; or &quot;//a&quot;
</code></pre>

<p><img src = './resources/figures/dom.png' ></img></p>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-20" style="background:;">
  <hgroup>
    <h2>如果指定 a 的 attribute 或 text</h2>
  </hgroup>
  <article data-timings="">
    <pre><code class="r">If we had &#39;&lt;a href = &quot;www.meetup.com/Taiwan-R&quot;&gt;Taiwan R User Group Website&lt;/a&gt;&#39;
</code></pre>

<p>抓出 href = ’www.meetup.com/Taiwan-R’ 的 a</p>

<pre><code class="r">&quot;//a[@href = ’www.meetup.com/Taiwan-R’]&quot;
</code></pre>

<p>抓出 text = ’Taiwan R User Group Website’ 的 a</p>

<pre><code class="r">&quot;//a[text() = ’Taiwan R User Group Website’]&quot;
</code></pre>

<pre><code class="r">nodename : a
attribute : href with value &quot;www.meetup.com/Taiwan-R&quot;
text: &quot;Taiwan R User Group Website&quot;
</code></pre>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-21" style="background:;">
  <hgroup>
    <h2>匯入套件</h2>
  </hgroup>
  <article data-timings="">
    <pre><code class="r">require(DSC2014Tutorial)
require(XML)
require(stringr)
require(xts)
require(reshape2)
</code></pre>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-22" style="background:;">
  <hgroup>
    <h2>開啟下載好的 html 檔案</h2>
  </hgroup>
  <article data-timings="">
    <h3><a href="https://tw.news.yahoo.com/real-estate/archive/1.html">資料來源 - yahoo 新聞</a></h3>

<pre><code class="r"># 讀取 ETL 相關檔案所在的路徑
path &lt;- ETL_file(&#39;&#39;)
docs &lt;- grep(&quot;*.html&quot;,dir(path), value = TRUE)
</code></pre>

<pre><code class="r">pages &lt;- sapply(docs, function(d){  
  path &lt;- ETL_file(d)
  f &lt;- file(path, encoding = &#39;UTF-8&#39;)
  f_size &lt;- file.info(ETL_file(d))$size
  content &lt;- readChar(f, f_size)
  close(f)
  return(content)
})
</code></pre>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-23" style="background:;">
  <hgroup>
    <h2>抓出 title和 連結</h2>
  </hgroup>
  <article data-timings="">
    <pre><code class="r">library(XML)
# 建立 DOM Tree
doc &lt;- htmlTreeParse(pages[1], useInternalNodes = TRUE)
# 抓出 node a 的 attr
attr &lt;- xpathApply(doc, &quot;//ul/li/div/div/h4/a&quot;, xmlAttrs)
# 抓出 node a 的 text
text &lt;- xpathSApply(doc, &quot;//ul/li/div/div/h4/a&quot;, xmlValue)
</code></pre>

<h3>text 結果</h3>

<pre><code>## [1] &quot;稅制改革座談 財長明督軍&quot;                      
## [2] &quot;缺地… 租稅引導產業南移&quot;                       
## [3] &quot;房地合一 建商：重稅擾民&quot;                      
## [4] &quot;租不起 「天天見麵」悄收台北店&quot;                
## [5] &quot;《世紀專欄》地價稅納稅義務基準日為每年8月31日&quot;
## [6] &quot;苗房屋標準單價公告調整 7月起實施&quot;
</code></pre>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-24" style="background:;">
  <article data-timings="">
    <p><img src = './resources/figures/xpath_title.png' ></img></p>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-25" style="background:;">
  <hgroup>
    <h2>一次抓多篇</h2>
  </hgroup>
  <article data-timings="">
    <pre><code class="r"># lapply : 最後將回傳 list 型態的結果
title &lt;- lapply(pages, function(p){
  doc &lt;- htmlTreeParse(p, useInternalNodes = TRUE)
  xpathSApply(doc, &quot;//ul/li/div/div/h4/a&quot;, xmlValue)
})
</code></pre>

<pre><code>## [[1]]
## [1] &quot;稅制改革座談 財長明督軍&quot; &quot;缺地… 租稅引導產業南移&quot; 
## 
## [[2]]
## [1] &quot;抗議一地兩價 遷建戶下跪向費鴻泰陳情&quot;
## [2] &quot;房產觀望氣氛 中市推案減兩成&quot;        
## 
## [[3]]
## [1] &quot;綠大地五股市區 千坪綠地&quot; &quot;在地專家&quot;
</code></pre>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-26" style="background:;">
  <hgroup>
    <h2>練習題1</h2>
  </hgroup>
  <article data-timings="">
    <h3>請填入適當的 xpath 抓出新聞來源, 日期, 時間</h3>

<pre><code class="r">src_list &lt;- xpathSApply(doc, ___ , xmlValue)
</code></pre>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-27" style="background:;">
  <article data-timings="">
    <p><img src = './resources/figures/xpath_time.png' ></img></p>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-28" style="background:;">
  <hgroup>
    <h2>解答1</h2>
  </hgroup>
  <article data-timings="">
    <pre><code class="r">src_list &lt;- xpathSApply(doc, &quot;//cite&quot;, xmlValue)

</code></pre>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-29" style="background:;">
  <hgroup>
    <h2>(自行操作) 保存/讀取 抓下來的數據</h2>
  </hgroup>
  <article data-timings="">
    <h3>先將結果合併為表格</h3>

<pre><code class="r">doc &lt;- do.call(rbind, title)
</code></pre>

<h3>寫入 / 讀回 數據</h3>

<pre><code class="r">writeLines(doc, &quot;news_yahoo.txt&quot;)
news_yahoo &lt;- readLines(&#39;news_yahoo.txt&#39;)
</code></pre>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-30" style="background:;">
  <hgroup>
    <h2>匯入這次用的資料</h2>
  </hgroup>
  <article data-timings="">
    <h3><a href="http://house.cnyes.com/News/tw_housenews/List.htm">資料來源 - 鉅亨網</a></h3>

<pre><code class="r">path &lt;- ETL_file(&#39;news.txt&#39;)
f &lt;- file(path, encoding=&quot;UTF-8&quot;)
house_news &lt;- readLines(f) 
head(house_news)
</code></pre>

<pre><code>## [1] &quot;2014-06-24富邦人壽信義區再插旗 A25案172億元奪標&quot;                          
## [2] &quot;2014-06-24北市A25地上權案 富邦權利金172.88億元得標&quot;                       
## [3] &quot;2014-06-23房市管制 央行將化明為暗&quot;                                        
## [4] &quot;2014-06-20史上頭一遭!大直新地王 1坪212萬＃超越信義之星直逼帝寶 中山新天價&quot;
## [5] &quot;2014-06-20大直帝景水花園實價首破200萬 北市3大豪宅板塊確立&quot;                
## [6] &quot;2014-06-19樺福千金捷運宅標脫率89.4% 均價63萬元屬合理範圍&quot;
</code></pre>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-31" style="background:;">
  <hgroup>
    <h2>CH2 字串處理</h2>
  </hgroup>
  <article data-timings="">
    
  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-32" style="background:;">
  <hgroup>
    <h2>正規表達 介紹</h2>
  </hgroup>
  <article data-timings="">
    <pre><code class="r">\\d -&gt; 數字 
\\w -&gt; 單字 
.   -&gt; 任意字元(數字, 單字, 標點符號 ..) 

?   -&gt; 出現 0或1 次 
+   -&gt; 出現 1次 以上 
*   -&gt; 出現 0次 以上 

^   -&gt; 出現在行首
$   -&gt; 出現在行尾

</code></pre>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-33" style="background:;">
  <article data-timings="">
    <pre><code class="r">x &lt;- c(&quot;apples*14&quot;, &quot;flour&quot;, &quot;sugar*100&quot;, &quot;milk*3&quot;)
</code></pre>

<h3>批配2個數字</h3>

<pre><code class="r">str_extract(x, &quot;\\d{2}&quot;)
</code></pre>

<pre><code>## [1] &quot;14&quot; NA   &quot;10&quot; NA
</code></pre>

<h3>批配2~3個數字</h3>

<pre><code class="r">str_extract(x, &quot;\\d{2,3}&quot;)
</code></pre>

<pre><code>## [1] &quot;14&quot;  NA    &quot;100&quot; NA
</code></pre>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-34" style="background:;">
  <article data-timings="">
    <pre><code class="r">x &lt;- c(&quot;apples*14&quot;, &quot;flour&quot;, &quot;sugar*100&quot;, &quot;milk*3&quot;)
</code></pre>

<h3>批配出現一次以上的a或p</h3>

<pre><code class="r">str_extract(x, &quot;[ap]+&quot;)
</code></pre>

<pre><code>## [1] &quot;app&quot; NA    &quot;a&quot;   NA
</code></pre>

<h3>也可以搭配{m,n}</h3>

<pre><code class="r">str_extract(x, &quot;[ap]{1,4}&quot;)
</code></pre>

<pre><code>## [1] &quot;app&quot; NA    &quot;a&quot;   NA
</code></pre>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-35" style="background:;">
  <hgroup>
    <h2>練習題2</h2>
  </hgroup>
  <article data-timings="">
    <h3>猜猜看這會批配出什麼東西？</h3>

<pre><code class="r">x &lt;- c(&quot;apples*14&quot;, &quot;flour&quot;, &quot;allen&quot;, &quot;aside&quot;)

str_extract(x, &quot;a[elpn]+.?&quot;)
</code></pre>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-36" style="background:;">
  <hgroup>
    <h2>解答2</h2>
  </hgroup>
  <article data-timings="">
    <pre><code class="r">x &lt;- c(&quot;apples*14&quot;, &quot;flour&quot;, &quot;allen&quot;, &quot;aside&quot;)

str_extract(x, &quot;a[elpn]+.?&quot;)
</code></pre>

<pre><code>## [1] &quot;apples&quot; NA       &quot;allen&quot;  NA
</code></pre>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-37" style="background:;">
  <hgroup>
    <h2>進階一點的正規表達</h2>
  </hgroup>
  <article data-timings="">
    <h3>抽取 log訊息時很有用的 () 批配</h3>

<h3>可以把 match 的字儲存倒 \{n}</h3>

<pre><code class="r">x &lt;-&quot;2014-06-24富邦人壽信義區再插旗 A25案172億元奪標&quot;
patten &lt;- &quot;(\\d{4}-\\d{2}-\\d{2}).+(信義.?).+&quot;

gsub(patten, &quot;\\1, \\2&quot;, x)
</code></pre>

<pre><code>## [1] &quot;2014-06-24, 信義區&quot;
</code></pre>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-38" style="background:;">
  <hgroup>
    <h2>練習題3</h2>
  </hgroup>
  <article data-timings="">
    <p>請利用下面提示，填入適當的 Patten，產生出下面結果</p>

<pre><code class="r"># 請利用 \\d{?}-\\d{?}-\\d{?} 抽取出時間 
dates &lt;- str_extract(house_news, ___)

# 請利用 \\d{?}-\\d{?}-\\d{?} 把時間取代為 &#39;&#39;
titles &lt;- str_replace(house_news, ___, ___)

house_news &lt;- cbind(dates, titles)
</code></pre>

<pre><code>##      dates        titles                                    
## [1,] &quot;2014-06-24&quot; &quot;富邦人壽信義區再插旗 A25案172億元奪標&quot;   
## [2,] &quot;2014-06-24&quot; &quot;北市A25地上權案 富邦權利金172.88億元得標&quot;
## [3,] &quot;2014-06-23&quot; &quot;房市管制 央行將化明為暗&quot;
</code></pre>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-39" style="background:;">
  <hgroup>
    <h2>解答3</h2>
  </hgroup>
  <article data-timings="">
    <pre><code class="r">dates &lt;- str_extract(house_news, &quot;\\d{4}-\\d{2}-\\d{2}&quot;)
titles &lt;- str_replace(house_news, &quot;\\d{4}-\\d{2}-\\d{2}&quot;, &quot;&quot;)

house_news &lt;- cbind(dates, titles)
</code></pre>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-40" style="background:;">
  <hgroup>
    <h2>清除符號的方法介紹</h2>
  </hgroup>
  <article data-timings="">
    <h3>[[:punct:]] 表示標點符號</h3>

<h3>[[:blank:]] 表示分隔符號</h3>

<pre><code class="r">str_replace_all(&quot;i l&lt;ik&gt;e ?R pr:ogr,a%mi!ng&quot;, &quot;[[:punct:]]&quot;, &quot;&quot;)
</code></pre>

<pre><code>## [1] &quot;i like R programing&quot;
</code></pre>

<pre><code class="r">str_replace_all(&quot;a \t p \t p &quot;, &quot;[[:blank:]]&quot;, &quot;&quot;)
</code></pre>

<pre><code>## [1] &quot;app&quot;
</code></pre>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-41" style="background:;">
  <hgroup>
    <h2>如果想清除中文特殊符號 ...</h2>
  </hgroup>
  <article data-timings="">
    <h3>這是 utf-8 編碼</h3>

<pre><code class="r">punctuation &lt;- &quot;\u3002 \uff1b \uff0c \uff1a \u201c \u201d \uff08 \uff09 \u3001 \uff1f \u300a \u300b&quot;

punctuation
</code></pre>

<pre><code>## [1] &quot;。 ； ， ： “ ” （ ） 、 ？ 《 》&quot;
</code></pre>

<pre><code class="r">str_replace_all(&quot;。 ； ， ： “ ” （ ） 、 ？ 《 》&quot;, punctuation, &quot;&quot;)
</code></pre>

<pre><code>## [1] &quot;&quot;
</code></pre>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-42">
<hgroup>
  
</hgroup>
<article class = 'flexbox vcenter'>
<p><q> 再來要介紹一個非常重要的 function </q></p>

</article>
<!-- Presenter Notes -->
</slide>
<slide class="" id="slide-43" style="background:;">
  <hgroup>
    <h2>substr 用法</h2>
  </hgroup>
  <article data-timings="">
    <pre><code class="r">substr(&#39;富邦人壽信義區再插旗 A25案172億元奪標&#39;, 1, 4)
</code></pre>

<pre><code>## [1] &quot;富邦人壽&quot;
</code></pre>

<pre><code class="r">substr(&#39;富邦人壽信義區再插旗 A25案172億元奪標&#39;, 5, 7)
</code></pre>

<pre><code>## [1] &quot;信義區&quot;
</code></pre>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-44">
<hgroup>
  
</hgroup>
<article class = 'flexbox vcenter'>
<p><q>看來很簡單,那為什麼說它很重要呢？</q></p>

</article>
<!-- Presenter Notes -->
</slide>
<slide class="" id="slide-45">
<hgroup>
  
</hgroup>
<article class = 'flexbox vcenter'>
<p><q> 做個練習可能就有感覺了 </q></p>

</article>
<!-- Presenter Notes -->
</slide>
<slide class="" id="slide-46" style="background:;">
  <hgroup>
    <h2>練習題4</h2>
  </hgroup>
  <article data-timings="">
    <h3>空格填 i or i+1，才呈現出下面使用範例？</h3>

<pre><code class="r">ngram &lt;- function(sentence, n){
  chunk &lt;- c()
  for(i in 1 : (nchar(sentence)-n+1)){
    chunk &lt;- append(chunk, substr(sentence, ___ , i+n-1))
  }
  return(chunk)
}
</code></pre>

<h3>使用範例</h3>

<pre><code class="r">ngram(&#39;富邦人壽信義區再插旗&#39;, 2)
</code></pre>

<pre><code>## [1] &quot;富邦&quot; &quot;邦人&quot; &quot;人壽&quot; &quot;壽信&quot; &quot;信義&quot; &quot;義區&quot; &quot;區再&quot; &quot;再插&quot; &quot;插旗&quot;
</code></pre>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-47" style="background:;">
  <hgroup>
    <h2>解答4</h2>
  </hgroup>
  <article data-timings="">
    <pre><code class="r">ngram &lt;- function(sentence, n){
  chunk &lt;- c()
  for(i in 1 : (nchar(sentence)-n+1)){
    chunk &lt;- append(chunk, substr(sentence, i, i+n-1))
  }
  return(chunk)
}
</code></pre>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-48" style="background:;">
  <article data-timings="">
    <pre><code class="r">sapply(titles, ngram, 2, USE.NAMES = FALSE)[1:3]
</code></pre>

<pre><code>## [[1]]
##  [1] &quot;富邦&quot; &quot;邦人&quot; &quot;人壽&quot; &quot;壽信&quot; &quot;信義&quot; &quot;義區&quot; &quot;區再&quot; &quot;再插&quot; &quot;插旗&quot; &quot;旗 &quot; 
## [11] &quot; A&quot;   &quot;A2&quot;   &quot;25&quot;   &quot;5案&quot;  &quot;案1&quot;  &quot;17&quot;   &quot;72&quot;   &quot;2億&quot;  &quot;億元&quot; &quot;元奪&quot;
## [21] &quot;奪標&quot;
## 
## [[2]]
##  [1] &quot;北市&quot; &quot;市A&quot;  &quot;A2&quot;   &quot;25&quot;   &quot;5地&quot;  &quot;地上&quot; &quot;上權&quot; &quot;權案&quot; &quot;案 &quot;  &quot; 富&quot; 
## [11] &quot;富邦&quot; &quot;邦權&quot; &quot;權利&quot; &quot;利金&quot; &quot;金1&quot;  &quot;17&quot;   &quot;72&quot;   &quot;2.&quot;   &quot;.8&quot;   &quot;88&quot;  
## [21] &quot;8億&quot;  &quot;億元&quot; &quot;元得&quot; &quot;得標&quot;
## 
## [[3]]
##  [1] &quot;房市&quot; &quot;市管&quot; &quot;管制&quot; &quot;制 &quot;  &quot; 央&quot;  &quot;央行&quot; &quot;行將&quot; &quot;將化&quot; &quot;化明&quot; &quot;明為&quot;
## [11] &quot;為暗&quot;
</code></pre>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-49" style="background:;">
  <article data-timings="">
    <pre><code class="r">sapply(titles, ngram, 3, USE.NAMES = FALSE)[1:3]
</code></pre>

<pre><code>## [[1]]
##  [1] &quot;富邦人&quot; &quot;邦人壽&quot; &quot;人壽信&quot; &quot;壽信義&quot; &quot;信義區&quot; &quot;義區再&quot; &quot;區再插&quot;
##  [8] &quot;再插旗&quot; &quot;插旗 &quot;  &quot;旗 A&quot;   &quot; A2&quot;    &quot;A25&quot;    &quot;25案&quot;   &quot;5案1&quot;  
## [15] &quot;案17&quot;   &quot;172&quot;    &quot;72億&quot;   &quot;2億元&quot;  &quot;億元奪&quot; &quot;元奪標&quot;
## 
## [[2]]
##  [1] &quot;北市A&quot;  &quot;市A2&quot;   &quot;A25&quot;    &quot;25地&quot;   &quot;5地上&quot;  &quot;地上權&quot; &quot;上權案&quot;
##  [8] &quot;權案 &quot;  &quot;案 富&quot;  &quot; 富邦&quot;  &quot;富邦權&quot; &quot;邦權利&quot; &quot;權利金&quot; &quot;利金1&quot; 
## [15] &quot;金17&quot;   &quot;172&quot;    &quot;72.&quot;    &quot;2.8&quot;    &quot;.88&quot;    &quot;88億&quot;   &quot;8億元&quot; 
## [22] &quot;億元得&quot; &quot;元得標&quot;
## 
## [[3]]
##  [1] &quot;房市管&quot; &quot;市管制&quot; &quot;管制 &quot;  &quot;制 央&quot;  &quot; 央行&quot;  &quot;央行將&quot; &quot;行將化&quot;
##  [8] &quot;將化明&quot; &quot;化明為&quot; &quot;明為暗&quot;
</code></pre>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-50">
<hgroup>
  
</hgroup>
<article class = 'flexbox vcenter'>
<p><q> 透過substr才能從文章裡抽出詞彙呀！ </q></p>

</article>
<!-- Presenter Notes -->
</slide>
<slide class="" id="slide-51" style="background:;">
  <hgroup>
    <h2>把字段長度1~6都列舉出來，並分別儲存</h2>
  </hgroup>
  <article data-timings="">
    <pre><code class="r">titles &lt;- gsub(&quot;\\s&quot;, &quot;&quot;, titles)
piece &lt;- list()

piece[[&#39;1&#39;]] &lt;- unlist(sapply(titles, ngram, 1, USE.NAMES = FALSE))
piece[[&#39;2&#39;]] &lt;- unlist(sapply(titles, ngram, 2, USE.NAMES = FALSE))
piece[[&#39;3&#39;]] &lt;- unlist(sapply(titles, ngram, 3, USE.NAMES = FALSE))
piece[[&#39;4&#39;]] &lt;- unlist(sapply(titles, ngram, 4, USE.NAMES = FALSE))
piece[[&#39;5&#39;]] &lt;- unlist(sapply(titles, ngram, 5, USE.NAMES = FALSE))
piece[[&#39;6&#39;]] &lt;- unlist(sapply(titles, ngram, 6, USE.NAMES = FALSE))
</code></pre>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-52">
<hgroup>
  
</hgroup>
<article class = 'flexbox vcenter'>
<p><q> 但是有個問題 ！ </q></p>

</article>
<!-- Presenter Notes -->
</slide>
<slide class="" id="slide-53" style="background:;">
  <article data-timings="">
    <pre><code class="r">sapply(titles, ngram, 3, USE.NAMES = FALSE)[1:3]
</code></pre>

<pre><code>## [[1]]
##  [1] &quot;富邦人&quot; &quot;邦人壽&quot; &quot;人壽信&quot; &quot;壽信義&quot; &quot;信義區&quot; &quot;義區再&quot; &quot;區再插&quot;
##  [8] &quot;再插旗&quot; &quot;插旗A&quot;  &quot;旗A2&quot;   &quot;A25&quot;    &quot;25案&quot;   &quot;5案1&quot;   &quot;案17&quot;  
## [15] &quot;172&quot;    &quot;72億&quot;   &quot;2億元&quot;  &quot;億元奪&quot; &quot;元奪標&quot;
## 
## [[2]]
##  [1] &quot;北市A&quot;  &quot;市A2&quot;   &quot;A25&quot;    &quot;25地&quot;   &quot;5地上&quot;  &quot;地上權&quot; &quot;上權案&quot;
##  [8] &quot;權案富&quot; &quot;案富邦&quot; &quot;富邦權&quot; &quot;邦權利&quot; &quot;權利金&quot; &quot;利金1&quot;  &quot;金17&quot;  
## [15] &quot;172&quot;    &quot;72.&quot;    &quot;2.8&quot;    &quot;.88&quot;    &quot;88億&quot;   &quot;8億元&quot;  &quot;億元得&quot;
## [22] &quot;元得標&quot;
## 
## [[3]]
## [1] &quot;房市管&quot; &quot;市管制&quot; &quot;管制央&quot; &quot;制央行&quot; &quot;央行將&quot; &quot;行將化&quot; &quot;將化明&quot; &quot;化明為&quot;
## [9] &quot;明為暗&quot;
</code></pre>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-54">
<hgroup>
  
</hgroup>
<article class = 'flexbox vcenter'>
<p><q>注意到了嗎？</q>
<q>裡面有很多沒意義的字串</q></p>

</article>
<!-- Presenter Notes -->
</slide>
<slide class="" id="slide-55">
<hgroup>
  
</hgroup>
<article class = 'flexbox vcenter'>
<p><q>如何解決呢？</q></p>

</article>
<!-- Presenter Notes -->
</slide>
<slide class="" id="slide-56">
<hgroup>
  
</hgroup>
<article class = 'flexbox vcenter'>
<p><q> &#39;房價偏&#39; 是不是一個有意義的詞彙呢？ </q></p>

</article>
<!-- Presenter Notes -->
</slide>
<slide class="" id="slide-57">
<hgroup>
  
</hgroup>
<article class = 'flexbox vcenter'>
<p><q> &#39;房價&#39; + &#39;偏&#39; 是否機率獨立？</q></p>

<p><q> &#39;房&#39; + &#39;價偏&#39; 是否機率獨立？</q></p>

</article>
<!-- Presenter Notes -->
</slide>
<slide class="" id="slide-58">
<hgroup>
  
</hgroup>
<article class = 'flexbox vcenter'>
<p><q> 服貿協議 </q></p>

<p><q> &#39;服貿協&#39; 右邊幾乎只能接 &#39;議&#39;</q></p>

<p><q> &#39;貿協議&#39; 左邊幾乎只能接 &#39;服&#39;</q></p>

</article>
<!-- Presenter Notes -->
</slide>
<slide class="" id="slide-59">
<hgroup>
  
</hgroup>
<article class = 'flexbox vcenter'>
<p><q> 利用這兩種性質來篩選掉沒意義的字串 </q></p>

</article>
<!-- Presenter Notes -->
</slide>
<slide class="" id="slide-60">
<hgroup>
  
</hgroup>
<article class = 'flexbox vcenter'>
<p><q> 但是程式該怎麼寫呢？ </q></p>

</article>
<!-- Presenter Notes -->
</slide>
<slide class="" id="slide-61">
<hgroup>
  
</hgroup>
<article class = 'flexbox vcenter'>
<p><q> 繼續用 substr ! </q></p>

<p><q> 然後加上一點簡單的正規表達 </q></p>

</article>
<!-- Presenter Notes -->
</slide>
<slide class="" id="slide-62" style="background:;">
  <hgroup>
    <h2>練習題5</h2>
  </hgroup>
  <article data-timings="">
    <h3>空格填 i or i+1，才能呈現出下一頁的使用範例？</h3>

<pre><code class="r">segmentWord &lt;- function(word){
  # nchar 算字串長度
  n &lt;- nchar(word)-1
  seg &lt;- lapply(1: n, function(i){
    w1 &lt;- substr(word, 1, i)
    w2 &lt;- substr(word, ___ , n+1)
    c(w1,w2)
  })
  return(seg)
}
</code></pre>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-63" style="background:;">
  <article data-timings="">
    <pre><code class="r">segmentWord(&#39;富邦銀&#39;)
</code></pre>

<pre><code>## [[1]]
## [1] &quot;富&quot;   &quot;邦銀&quot;
## 
## [[2]]
## [1] &quot;富邦&quot; &quot;銀&quot;
</code></pre>

<pre><code class="r">segmentWord(&#39;大同區全&#39;)
</code></pre>

<pre><code>## [[1]]
## [1] &quot;大&quot;     &quot;同區全&quot;
## 
## [[2]]
## [1] &quot;大同&quot; &quot;區全&quot;
## 
## [[3]]
## [1] &quot;大同區&quot; &quot;全&quot;
</code></pre>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-64" style="background:;">
  <hgroup>
    <h2>解答5</h2>
  </hgroup>
  <article data-timings="">
    <pre><code class="r">segmentWord &lt;- function(word){
  n &lt;- nchar(word)-1
  seg &lt;- lapply(1: n, function(i){
    w1 &lt;- substr(word, 1, i)
    w2 &lt;- substr(word,i+1, n+1)
    c(w1,w2)
  })
  return(seg)
}
</code></pre>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-65">
<hgroup>
  
</hgroup>
<article class = 'flexbox vcenter'>
<p><q>已經會把字串兩個兩個拆開</q>
<q>但是機率從哪來 ? </q></p>

</article>
<!-- Presenter Notes -->
</slide>
<slide class="" id="slide-66" style="background:;">
  <hgroup>
    <h2>操作</h2>
  </hgroup>
  <article data-timings="">
    <h3>算 字段 出現次數</h3>

<pre><code class="r">words_freq &lt;- table(unlist(piece))
</code></pre>

<pre><code>## 
## 信義區   北市   房價   房市   上漲 
##      8     81     38     33      2
</code></pre>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-67" style="background:;">
  <hgroup>
    <h2>操作</h2>
  </hgroup>
  <article data-timings="">
    <h3>算出機率</h3>

<pre><code class="r">N &lt;- sum(words_freq[piece[[&#39;1&#39;]]])
words_prob &lt;- words_freq / N
</code></pre>

<pre><code>## 
##         龍江       龍江路     龍江路土   龍江路土地 龍江路土地由 
##    4.155e-06    4.155e-06    4.155e-06    4.155e-06    4.155e-06
</code></pre>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-68">
<hgroup>
  
</hgroup>
<article class = 'flexbox vcenter'>
<p><q> 以下這種性質要怎麼寫出程式呢？ </q></p>

<p><q> &#39;服貿協&#39; 右邊幾乎只能接 &#39;議&#39;</q></p>

<p><q> &#39;貿協議&#39; 左邊幾乎只能接 &#39;服&#39;</q></p>

</article>
<!-- Presenter Notes -->
</slide>
<slide class="" id="slide-69" style="background:;">
  <hgroup>
    <h2>paste, grep 用法</h2>
  </hgroup>
  <article data-timings="">
    <pre><code class="r">paste(&quot;富邦&quot; ,&quot;人壽&quot;, sep=&#39;&#39;)
</code></pre>

<pre><code>## [1] &quot;富邦人壽&quot;
</code></pre>

<pre><code class="r">grep(&#39;富邦&#39; , c(&#39;富邦金&#39;, &#39;法人富邦&#39;, &#39;台北富邦銀行&#39;))
</code></pre>

<pre><code>## [1] 1 2 3
</code></pre>

<pre><code class="r">grep(&#39;^富邦&#39; , c(&#39;富邦金&#39;, &#39;法人富邦&#39;, &#39;台北富邦銀行&#39;))
</code></pre>

<pre><code>## [1] 1
</code></pre>

<pre><code class="r">grep(&#39;富邦$&#39; , c(&#39;富邦金&#39;, &#39;法人富邦&#39;, &#39;台北富邦銀行&#39;))
</code></pre>

<pre><code>## [1] 2
</code></pre>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-70" style="background:;">
  <hgroup>
    <h2>練習題6</h2>
  </hgroup>
  <article data-timings="">
    <h3>請找出 &#39;義區&#39; 開頭/結尾 的字串</h3>

<h3>可以參考上一頁</h3>

<pre><code class="r">word &lt;- &#39;義區&#39;

# 找出比 &#39;義區&#39; 字串長度 多1 的所有字串
BASE &lt;- piece[[as.character(nchar(word)+1)]]

# 找出 &#39;義區&#39; 開頭的字串
PATTEN1 &lt;- paste( __ , &#39;義區&#39;, sep = &#39;&#39;)
matchs1 &lt;- grep(PATTEN1 , BASE, value = TRUE)

# 找出 &#39;義區&#39; 結尾的字串
PATTEN2 &lt;- paste(&#39;義區&#39; , __ , sep = &#39;&#39;)
matchs2 &lt;- grep(PATTEN2 , BASE, value = TRUE)

</code></pre>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-71" style="background:;">
  <hgroup>
    <h2>解答6</h2>
  </hgroup>
  <article data-timings="">
    <pre><code class="r">word &lt;- &#39;義區&#39;

# 找出比 &#39;義區&#39; 字串長度 多1 的所有字串
BASE &lt;- piece[[as.character(nchar(word)+1)]]

# 找出 &#39;義區&#39; 開頭的字串
PATTEN1 &lt;- paste(&#39;^&#39;, &#39;義區&#39;, sep = &#39;&#39;)
matchs1 &lt;- grep(PATTEN1 ,BASE , value = TRUE)

# 找出 &#39;義區&#39; 結尾的字串
PATTEN2 &lt;- paste(&#39;義區&#39; ,&#39;$&#39;, sep = &#39;&#39; )
matchs2 &lt;- grep(PATTEN2 ,BASE , value = TRUE)
</code></pre>

<pre><code>## [1] &quot;義區再&quot; &quot;義區「&quot; &quot;義區豪&quot; &quot;義區螺&quot; &quot;義區最&quot; &quot;義區大&quot; &quot;義區竹&quot; &quot;義區豪&quot;
</code></pre>

<pre><code>## [1] &quot;信義區&quot; &quot;信義區&quot; &quot;信義區&quot; &quot;信義區&quot; &quot;信義區&quot; &quot;信義區&quot; &quot;信義區&quot; &quot;信義區&quot;
</code></pre>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-72" style="background:;">
  <hgroup>
    <h2>挑出單字長度 2~5 的 候選詞彙</h2>
  </hgroup>
  <article data-timings="">
    <pre><code class="r">words_2_5 &lt;- unique(unlist(piece[2:5]))
</code></pre>

<pre><code>##  [1] &quot;站房市交易&quot; &quot;繼太&quot;       &quot;大街1坪&quot;    &quot;攻防江揆重&quot; &quot;向球金融海&quot;
##  [6] &quot;打房無&quot;     &quot;炒房在野又&quot; &quot;國6月開&quot;    &quot;圈周&quot;       &quot;線成北市房&quot;
## [11] &quot;到透天&quot;     &quot;大樓投報率&quot; &quot;府入駐重&quot;   &quot;當家&quot;       &quot;52%士&quot;
</code></pre>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-73">
<hgroup>
  <h2>長度2~5的 單字 出現次數分佈</h2>
</hgroup>
<article class = 'flexbox vcenter'>
<p><img src="assets/fig/unnamed-chunk-39.png" alt="plot of chunk unnamed-chunk-39"> </p>

</article>
<!-- Presenter Notes -->
</slide>
<slide class="" id="slide-74" style="background:;">
  <hgroup>
    <h2>找出 words_2_5 出現次數&gt;2 的詞彙</h2>
  </hgroup>
  <article data-timings="">
    <pre><code class="r">words &lt;- names(which(words_freq[words_2_5] &gt; 2))
</code></pre>

<pre><code>## 
##     逾3.5% 捷運松山線 上半年完成 半年完成募 年完成募集      14-03 
##          3          3          3          3          3          3 
##      4-03-      14-02      4-02- 地政士法覆 政士法覆議 ：豪宅交易 
##          3          3          3          7          7          3 
##      14-01      4-01-   25日前提 
##          3          3          3
</code></pre>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-75" style="background:;">
  <hgroup>
    <h2>CH3 進行聚合</h2>
  </hgroup>
  <article data-timings="">
    
  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-76" style="background:;">
  <hgroup>
    <h2>前面 segmentWord 練習題的使用</h2>
  </hgroup>
  <article data-timings="">
    <h3>ex. 算&#39;子字串&#39;之間是否獨立</h3>

<pre><code class="r">cohesion &lt;- function(word){

  # 先把 word切成兩個子字串
  seg &lt;- segmentWord(word)

  val &lt;- sapply(seg, function(x){    
    f_word &lt;- words_freq[word]

    # 兩塊子字串的出現次數
    f_x1 &lt;- words_freq[x[1]]
    f_x2 &lt;- words_freq[x[2]]

    # 兩塊子字串是否獨立
    mi &lt;- log2(N) + log2(f_word) - log2(f_x1) - log2(f_x2)
    return(mi)
  }) 
  return (min(val))
}
</code></pre>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-77" style="background:;">
  <hgroup>
    <h2>進行計算</h2>
  </hgroup>
  <article data-timings="">
    <pre><code class="r">cohesion_val &lt;- sapply(words, cohesion, USE.NAMES = FALSE)
names(cohesion_val) &lt;- words

# 挑大於10的原因請看一下一頁
coh_words &lt;- names(which(cohesion_val &gt; 10))
</code></pre>

<pre><code>##   賃需求     青睞   邦人壽   完成募 完成募集     揭露     募集     共識 
##    15.55    15.88    15.88    15.88    15.88    15.88    15.88    16.29 
##     汐止     影響 
##    16.29    16.29
</code></pre>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-78" style="background:;">
  <article data-timings="">
    <p><img src="assets/fig/unnamed-chunk-45.png" alt="plot of chunk unnamed-chunk-45"> </p>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-79" style="background:;">
  <hgroup>
    <h3>計算單字左右兩邊可以串接其他單字的程度</h3>
  </hgroup>
  <article data-timings="">
    <pre><code class="r">disorder &lt;- function(word){  
  # 其實只是練習6的內容，加上算亂度
  BASE &lt;- piece[[as.character(nchar(word)+1)]]

  PATTEN1 &lt;- paste(&quot;^&quot;, word, sep = &#39;&#39;)
  matchs1 &lt;- grep(PATTEN1, BASE, value = TRUE)
  freq1 &lt;- table(matchs1)  
  pre &lt;- mean(-log2(freq1/sum(freq1)))

  PATTEN2 &lt;- paste(word, &quot;$&quot;, sep = &#39;&#39;)
  matchs2 &lt;- grep(PATTEN2, BASE, value = TRUE)
  freq2 &lt;- table(matchs2)  
  post &lt;- mean(-log2(freq2/sum(freq2)))

  index &lt;- is.na(c(pre, post))
  condition &lt;- any(index)
  return(ifelse(condition, c(pre, post)[!index], min(pre, post)))  
}
</code></pre>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-80" style="background:;">
  <hgroup>
    <h2>進行計算</h2>
  </hgroup>
  <article data-timings="">
    <pre><code class="r">disorder_val &lt;- sapply(coh_words, disorder, USE.NAMES = FALSE)
names(disorder_val) &lt;- coh_words
</code></pre>

<pre><code>##     土地       -0     捷運     信義 實價登錄     去年     雙北     實價 
##    3.000    3.188    3.233    3.238    3.295    3.298    3.379    3.394 
##     億元     交易     住宅     店面     豪宅     每坪     北市 
##    3.400    3.434    3.788    4.059    4.232    4.302    5.160
</code></pre>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-81">
<hgroup>
  <h2>單字兩側的混亂程度分佈</h2>
</hgroup>
<article class = 'flexbox vcenter'>
<p><img src="assets/fig/unnamed-chunk-49.png" alt="plot of chunk unnamed-chunk-49"> </p>

</article>
<!-- Presenter Notes -->
</slide>
<slide class="" id="slide-82" style="background:;">
  <hgroup>
    <h2>挑出混亂程度 &gt;1 的字串</h2>
  </hgroup>
  <article data-timings="">
    <pre><code class="r">dis_words &lt;- names(which(disorder_val &gt; 1))
</code></pre>

<pre><code>##  [1] &quot;合宜住宅&quot;   &quot;店面租賃&quot;   &quot;張盛和：&quot;   &quot;房市量縮&quot;   &quot;北市2月&quot;   
##  [6] &quot;住宅價格&quot;   &quot;房價年漲&quot;   &quot;房價漲幅&quot;   &quot;豪宅交易&quot;   &quot;實價登錄&quot;  
## [11] &quot;中山區最&quot;   &quot;店面交易&quot;   &quot;180萬&quot;      &quot;商用大樓&quot;   &quot;價潛力區&quot;  
## [16] &quot;地政士法&quot;   &quot;月實價登錄&quot; &quot;信義計畫區&quot; &quot;：豪宅交易&quot; &quot;25日前提&quot;
</code></pre>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-83" style="background:;">
  <hgroup>
    <h2>混亂程度的例子</h2>
  </hgroup>
  <article data-timings="">
    <h3>兩側混亂程度高的字</h3>

<pre><code>##  [1] &quot;土地&quot;     &quot;-0&quot;       &quot;捷運&quot;     &quot;信義&quot;     &quot;實價登錄&quot; &quot;去年&quot;    
##  [7] &quot;雙北&quot;     &quot;實價&quot;     &quot;億元&quot;     &quot;交易&quot;     &quot;住宅&quot;     &quot;店面&quot;    
## [13] &quot;豪宅&quot;     &quot;每坪&quot;     &quot;北市&quot;
</code></pre>

<h3>兩側混亂程度低的字</h3>

<pre><code>##  [1] &quot;富邦&quot; &quot;邦人&quot; &quot;人壽&quot; &quot;義區&quot; &quot;地上&quot; &quot;上權&quot; &quot;權案&quot; &quot;權利&quot; &quot;利金&quot; &quot;義之&quot;
## [11] &quot;之星&quot; &quot;下半&quot; &quot;樂觀&quot; &quot;新隆&quot; &quot;隆國&quot;
</code></pre>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-84">
<hgroup>
  
</hgroup>
<article class = 'flexbox vcenter'>
<p><q> 到這邊真是辛苦大家了 ... </q>
<q> 我們總算挑出有意義的字串了 歐耶！ </q></p>

</article>
<!-- Presenter Notes -->
</slide>
<slide class="" id="slide-85">
<hgroup>
  
</hgroup>
<article class = 'flexbox vcenter'>
<p><q> 接下來我們算出關鍵字的出現次數 </q></p>

<p><q> 然後把各個出現次數合併起來就好了 </q></p>

</article>
<!-- Presenter Notes -->
</slide>
<slide class="" id="slide-86">
<hgroup>
  
</hgroup>
<article class = 'flexbox vcenter'>
<p><q>這步驟 用 R 做起來真的是很輕鬆愉快 </q>
<q> 讓我們介紹一個很強大的 function </q></p>

</article>
<!-- Presenter Notes -->
</slide>
<slide class="" id="slide-87" style="background:;">
  <hgroup>
    <h2>str_count 用法</h2>
  </hgroup>
  <article data-timings="">
    <h3>算 a, e 出現次數</h3>

<pre><code class="r">fruit &lt;- c(&quot;apple&quot;, &quot;banana&quot;, &quot;pear&quot;, &quot;pineapple&quot;)

lapply(c(&quot;a&quot;, &quot;e&quot;), function(x){
  str_count(fruit, x)
})
</code></pre>

<pre><code>## [[1]]
## [1] 1 3 1 1
## 
## [[2]]
## [1] 1 0 1 2
</code></pre>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-88" style="background:;">
  <hgroup>
    <h2>練習題7</h2>
  </hgroup>
  <article data-timings="">
    <h3>dis_words 裡面每個單字在新聞 title 的出現次數是多少？</h3>

<h3>請填入 dis_words 和 title</h3>

<pre><code class="r">tmp &lt;- lapply( __ , function(word){ 
  # 算出 word 在title的出現次數
  str_count( __ , word)
})
# 把算出來結果，用 column combind 成一張表格
words_tbl &lt;- do.call(cbind, tmp)
colnames(words_tbl) &lt;- dis_words
</code></pre>

<pre><code>##      月實價登錄 內湖 25日前提 平均 萬華 山區 高雄 學區
## [1,]          0    0        0    0    0    0    0    0
## [2,]          0    0        0    0    0    0    0    0
## [3,]          0    0        0    0    0    0    0    0
## [4,]          0    0        0    0    0    0    0    0
</code></pre>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-89" style="background:;">
  <hgroup>
    <h2>解答7</h2>
  </hgroup>
  <article data-timings="">
    <pre><code class="r"># 把 dis_words裡面的字一個一個送進去做運算
tmp &lt;- lapply(dis_words, function(word){
  # 算出 word 在title的出現次數
  str_count(titles, word)
})

# 把算出來結果，用 column combind 成一張表格
words_tbl &lt;- do.call(cbind, tmp)
colnames(words_tbl) &lt;- dis_words
words_tbl[1:6, sample(ncol(words_tbl), 8)]
</code></pre>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-90">
<hgroup>
  
</hgroup>
<article class = 'flexbox vcenter'>
<p><q> 我們今天的課程就到這邊 </q></p>

<p><q> 希望大家已經學到以下幾件事情 </q></p>

</article>
<!-- Presenter Notes -->
</slide>
<slide class="" id="slide-91">
<hgroup>
  
</hgroup>
<article class = 'flexbox vcenter'>
<p><q> xpath + web scraping 的概念 </q></p>

<p><q> 利用正規表達來抽出需要的資訊 </q></p>

<p><q> 瞭解兩種方法來取出有意義的字串 </q></p>

<p><q> 計算字串的出現次數，與整理成出現次數表格 </q></p>

</article>
<!-- Presenter Notes -->
</slide>
<slide class="" id="slide-92">
<hgroup>
  
</hgroup>
<article class = 'flexbox vcenter'>
<p><q> 後面的投影片可以回家自行服用</q>
<q> 不用客氣 </q></p>

</article>
<!-- Presenter Notes -->
</slide>
<slide class="" id="slide-93" style="background:;">
  <hgroup>
    <h2>xts 用法</h2>
  </hgroup>
  <article data-timings="">
    <pre><code class="r">x &lt;- matrix(1:10, 2,2)
y &lt;- Sys.Date() + 1:2

xts(x,y)
</code></pre>

<pre><code>##      [,1] [,2]
## [1,]    1    3
## [2,]    2    4
</code></pre>

<pre><code>## [1] &quot;2014-08-30&quot; &quot;2014-08-31&quot;
</code></pre>

<pre><code>##            [,1] [,2]
## 2014-08-30    1    3
## 2014-08-31    2    4
</code></pre>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-94" style="background:;">
  <hgroup>
    <h2>練習題8</h2>
  </hgroup>
  <article data-timings="">
    <h3>請將 words_tbl 轉換成 xts 格式</h3>

<h3>提示：就是要轉 words_tbl ！！</h3>

<pre><code class="r">words_tbl_xts &lt;- xts( ___ , as.POSIXct(dates))
</code></pre>

<pre><code>##            信義 億元 北市 直逼 中山 實價 豪宅 捷運
## 2014-01-02    0    0    0    0    0    0    0    0
## 2014-01-02    0    0    1    0    0    0    0    0
## 2014-01-02    0    0    0    0    0    0    0    0
## 2014-01-02    0    0    1    0    0    0    0    0
## 2014-01-03    0    0    0    0    0    0    0    0
## 2014-01-03    0    0    1    0    0    0    0    0
</code></pre>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-95" style="background:;">
  <hgroup>
    <h2>解答8</h2>
  </hgroup>
  <article data-timings="">
    <pre><code class="r">words_tbl_xts &lt;- xts(words_tbl, as.POSIXct(dates))
</code></pre>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-96" style="background:;">
  <hgroup>
    <h2>轉成 xts 格式的好處</h2>
  </hgroup>
  <article data-timings="">
    <h3>可以選取時間</h3>

<pre><code class="r">words_tbl_xts[&quot;2014-01-18/2014-01-20&quot;, 100:110]
</code></pre>

<pre><code>##            預計 內湖 居住 春節 文山 總銷 點閱 覆議 政院 江揆 推案
## 2014-01-19    0    0    0    0    0    0    0    0    0    0    0
## 2014-01-20    0    0    0    0    0    0    0    1    1    0    0
## 2014-01-20    0    0    0    0    0    0    0    0    0    1    0
## 2014-01-20    0    0    0    0    0    0    0    1    1    1    0
## 2014-01-20    0    0    0    0    0    0    0    1    1    1    0
## 2014-01-20    0    0    0    0    0    0    0    0    0    0    0
## 2014-01-20    0    0    0    0    0    0    0    1    1    0    0
</code></pre>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-97" style="background:;">
  <hgroup>
    <h2>轉成 xts 格式的好處</h2>
  </hgroup>
  <article data-timings="">
    <h3>可以對時間區間做運算, 例如 將 1~2月 每個禮拜的出現次數做加總</h3>

<pre><code class="r">ep.weeks &lt;- endpoints(words_tbl_xts, &quot;weeks&quot;, k=1)
count.weeks &lt;- period.apply(words_tbl_xts, ep.weeks, FUN=colSums)
count.weeks[&quot;2014-01/2014-02&quot;, 100:110]
</code></pre>

<pre><code>##            預計 內湖 居住 春節 文山 總銷 點閱 覆議 政院 江揆 推案
## 2014-01-06    0    0    0    0    0    1    0    0    0    0    0
## 2014-01-10    0    0    0    0    0    1    0    0    0    0    2
## 2014-01-20    0    0    0    1    0    0    0    4    4    3    0
## 2014-01-27    0    0    0    0    3    0    0    5    2    2    1
## 2014-01-28    0    0    1    0    0    0    0    2    2    0    0
## 2014-02-07    0    0    0    2    2    0    2    0    0    0    0
## 2014-02-17    0    0    0    0    0    0    1    0    0    0    0
## 2014-02-24    0    1    0    0    1    2    0    0    0    0    0
</code></pre>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-98" style="background:;">
  <hgroup>
    <h2>練習題9</h2>
  </hgroup>
  <article data-timings="">
    <h3>請計算每個單字在 1~5 月的 每個月出現次數</h3>

<h3>填入 weeks or months ?</h3>

<h3>填入 2014-?/2014-?</h3>

<pre><code class="r">ep.month &lt;- endpoints(words_tbl_xts, ___ , k=1)
count.month &lt;- period.apply(words_tbl_xts, __ , FUN=colSums)
count.months[ ___ , 100:110]
</code></pre>

<pre><code>##            預計 內湖 居住 春節 文山 總銷 點閱 覆議 政院 江揆 推案
## 2014-01-28    0    0    1    1    3    2    0   11    8    5    3
## 2014-02-27    0    3    0    3    3    2    3    0    0    0    0
## 2014-03-31    3    1    3    0    0    0    0    0    0    0    0
## 2014-04-30    0    0    0    0    0    0    0    0    0    0    0
## 2014-05-30    0    0    0    0    0    0    0    0    0    0    0
</code></pre>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-99" style="background:;">
  <hgroup>
    <h2>解答9</h2>
  </hgroup>
  <article data-timings="">
    <pre><code class="r">ep.months &lt;- endpoints(words_tbl_xts, &quot;months&quot;, k=1)
count.months &lt;- period.apply(words_tbl_xts, ep.months, FUN=colSums)
count.months[&quot;2014-01/2014-05&quot;, 100:110]
</code></pre>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-100" style="background:;">
  <hgroup>
    <h2>CH4 (番外篇) 抓股票找狀態</h2>
  </hgroup>
  <article data-timings="">
    <h3>這一章節可以自己操作</h3>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-101" style="background:;">
  <hgroup>
    <h2>自行操作</h2>
  </hgroup>
  <article data-timings="">
    <h3>下載營建股 股票指數</h3>

<h3><a href="http://www.wantgoo.com/stock/classcont.aspx?id=32">營建股清單</a></h3>

<pre><code class="r">library(&#39;quantmod&#39;)
f = file(ETL_file(&#39;stock.csv&#39;), encoding=&#39;utf-8&#39;)
stock &lt;- read.csv(f, stringsAsFactors=FALSE)

stock_no &lt;- stock[,1]
stock_name &lt;- stock[,2]
stock_code &lt;- paste(stock_no, &#39;.TW&#39;, sep=&#39;&#39;)
</code></pre>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-102" style="background:;">
  <hgroup>
    <h2>自行操作</h2>
  </hgroup>
  <article data-timings="">
    <h3>開始下載</h3>

<pre><code class="r">mystocks &lt;- new.env()
getSymbols(stock_code, env=mystocks, from=&quot;2014-01-01&quot;, to=&quot;2014-07-02&quot;)
mystocks &lt;- do.call(cbind,eapply(mystocks, Cl))
names(mystocks) &lt;- stock_name
saveRDS(mystocks, &quot;mystocks.rds&quot;)
</code></pre>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-103" style="background:;">
  <hgroup>
    <h2>自行操作</h2>
  </hgroup>
  <article data-timings="">
    <h3>算出每支股票的 平均漲跌</h3>

<pre><code class="r">mystocks &lt;- readRDS(ETL_file(&#39;mystocks.rds&#39;))
mystocks.return &lt;- diff(mystocks, 1) / mystocks
</code></pre>

<pre><code>##               華友聯      名軒      寶徠      潤隆      國建
## 2014-01-01        NA        NA        NA        NA        NA
## 2014-01-02  0.004545  0.005310 -0.008333 -0.006390 -0.001631
## 2014-01-03 -0.013825 -0.005338  0.012346 -0.006431 -0.003273
## 2014-01-06 -0.004630 -0.008977 -0.021008 -0.054237 -0.006590
## 2014-01-07  0.000000  0.003578  0.004184  0.018303  0.017799
## 2014-01-08  0.022624  0.001786 -0.012712  0.003317  0.006431
</code></pre>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-104" style="background:;">
  <hgroup>
    <h3>全部平均來看漲幅</h3>
  </hgroup>
  <article data-timings="">
    <pre><code class="r">mystocks.return_all &lt;- apply(mystocks.return[-1,], 1, mean)
</code></pre>

<p><img src="assets/fig/unnamed-chunk-66.png" alt="plot of chunk unnamed-chunk-66"> </p>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-105" style="background:;">
  <hgroup>
    <h2>自行操作</h2>
  </hgroup>
  <article data-timings="">
    <h3>找出股票漲跌的五個狀態</h3>

<h3>漲多,、漲少,、不變,、跌少,、跌多</h3>

<h3>利用 kmeans 來判斷</h3>

<pre><code class="r">cl &lt;- kmeans(mystocks.return_all, 5)
</code></pre>

<pre><code>## 2014-01-02 2014-01-03 2014-01-06 2014-01-07 2014-01-08 
##          4          3          5          1          4
</code></pre>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-106" style="background:;">
  <hgroup>
    <h2>自行操作</h2>
  </hgroup>
  <article data-timings="">
    <h3>對狀態做排序</h3>

<pre><code class="r">s1 = c()

for(i in 1:5){
  i = as.character(i)
  s1[i] &lt;- mean(mystocks.return_all[cl$cluster == i]) 
}
s1 &lt;- sort(s1)
</code></pre>

<pre><code>##          5          3          4          2          1 
## -0.0224974 -0.0049706 -0.0005121  0.0035959  0.0092449
</code></pre>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-107" style="background:;">
  <hgroup>
    <h2>自行操作</h2>
  </hgroup>
  <article data-timings="">
    <h3>把狀態換個名字</h3>

<pre><code class="r">s2 = c(&#39;跌多&#39;,&#39;跌少&#39;,&#39;不變&#39;,&#39;漲少&#39;,&#39;漲多&#39;)
for(i in 1:5){
  cl$cluster &lt;- gsub(names(s1)[i], s2[i], cl$cluster)
}

return.status &lt;- data.frame(cluster=cl$cluster, count=rep(1, length(cl$cluster)))
</code></pre>

<pre><code>##   cluster count
## 1    不變     1
## 2    跌少     1
## 3    跌多     1
## 4    漲多     1
## 5    不變     1
## 6    跌少     1
</code></pre>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-108" style="background:;">
  <hgroup>
    <h2>CH5 表格操作與轉換</h2>
  </hgroup>
  <article data-timings="">
    
  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-109" style="background:;">
  <hgroup>
    <h2>注意</h2>
  </hgroup>
  <article data-timings="">
    <h3>後面只是整理出表格</h3>

<h3>有看似任何分析方法請不要直接拿來使用</h3>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-110" style="background:;">
  <hgroup>
    <h2>可以合併在一起看 ?</h2>
  </hgroup>
  <article data-timings="">
    
<div style='float:left;width:48%;' class='centered'>
  <h3><code>關鍵字出現的次數</code></h3>

<pre><code>##      預計 內湖 居住 春節 文山 總銷
## [1,]    0    0    0    0    0    0
## [2,]    0    0    0    0    0    0
## [3,]    0    0    0    0    0    0
## [4,]    0    0    0    0    0    0
## [5,]    0    0    0    0    0    0
## [6,]    0    0    0    0    0    0
</code></pre>

</div>
<div style='float:right;width:48%;'>
  <h3><code>股市漲跌的狀態</code></h3>

<pre><code>##   cluster count
## 1    不變     1
## 2    跌少     1
## 3    跌多     1
## 4    漲多     1
## 5    不變     1
## 6    跌少     1
</code></pre>

</div>
  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-111" style="background:;">
  <hgroup>
    <h2>可以把<code>5個漲跌狀態</code>變成欄位 ?</h2>
  </hgroup>
  <article data-timings="">
    
<div style='float:left;width:48%;' class='centered'>
  <h3>原本的表格</h3>

<pre><code>##   cluster count
## 1    不變     1
## 2    跌少     1
## 3    跌多     1
## 4    漲多     1
## 5    不變     1
## 6    跌少     1
</code></pre>

</div>
<div style='float:right;width:48%;'>
  <h3>希望的表格</h3>

<pre><code>##   return_date 不變 漲多 漲少 跌多 跌少
## 1  2014-01-02    1    0    0    0    0
## 2  2014-01-03    0    0    0    0    1
## 3  2014-01-06    0    0    0    1    0
## 4  2014-01-07    0    1    0    0    0
## 5  2014-01-08    1    0    0    0    0
## 6  2014-01-09    0    0    0    0    1
</code></pre>

</div>
  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-112" style="background:;">
  <hgroup>
    <h2>melt, dcast 用法</h2>
  </hgroup>
  <article data-timings="">
    <h3>先準備一份資料</h3>

<pre><code class="r">x = matrix(letters[1:12], 4,3)
x &lt;- as.data.frame(x)
names(x) &lt;- c(&#39;w1&#39;, &#39;w2&#39;, &#39;w3&#39;)
</code></pre>

<pre><code>##   w1 w2 w3
## 1  a  e  i
## 2  b  f  j
## 3  c  g  k
## 4  d  h  l
</code></pre>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-113" style="background:;">
  <hgroup>
    <h2>melt, dcast 用法</h2>
  </hgroup>
  <article data-timings="">
    <pre><code class="r">x.m &lt;- melt(x, id.vars = c(&#39;w1&#39;, &#39;w2&#39;))
</code></pre>

<pre><code>##   w1 w2 variable value
## 1  a  e       w3     i
## 2  b  f       w3     j
## 3  c  g       w3     k
## 4  d  h       w3     l
</code></pre>

<pre><code class="r">x.dc &lt;- dcast(x.m, w1+w2 ~ variable)
</code></pre>

<pre><code>##   w1 w2 w3
## 1  a  e  i
## 2  b  f  j
## 3  c  g  k
## 4  d  h  l
</code></pre>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-114" style="background:;">
  <hgroup>
    <h2>練習題10</h2>
  </hgroup>
  <article data-timings="">
    <h3>請利用 return_date 和 cluster 整理出下面表格</h3>

<pre><code class="r">return_date &lt;- names(mystocks.return_all)

return.status &lt;- dcast(return.status, ___  ~ ___ , fill = 0)
</code></pre>

<pre><code>##   return_date 不變 漲多 漲少 跌多 跌少
## 1  2014-01-02    1    0    0    0    0
## 2  2014-01-03    0    0    0    0    1
## 3  2014-01-06    0    0    0    1    0
## 4  2014-01-07    0    1    0    0    0
## 5  2014-01-08    1    0    0    0    0
## 6  2014-01-09    0    0    0    0    1
</code></pre>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-115" style="background:;">
  <hgroup>
    <h2>解答10</h2>
  </hgroup>
  <article data-timings="">
    <pre><code class="r">return_date &lt;- names(mystocks.return_all)

return.status &lt;- dcast(return.status, return_date  ~ cluster, fill = 0)
</code></pre>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-116" style="background:;">
  <hgroup>
    <h2>將 return.status 轉換成<code>xts</code>格式</h2>
  </hgroup>
  <article data-timings="">
    <pre><code class="r">return.status.xts &lt;- xts(return.status[,-1], as.POSIXct(return_date))
</code></pre>

<pre><code>##            不變 漲多 漲少 跌多 跌少
## 2014-01-02    1    0    0    0    0
## 2014-01-03    0    0    0    0    1
## 2014-01-06    0    0    0    1    0
## 2014-01-07    0    1    0    0    0
## 2014-01-08    1    0    0    0    0
## 2014-01-09    0    0    0    0    1
</code></pre>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-117" style="background:;">
  <hgroup>
    <h2>merge.xts 用法</h2>
  </hgroup>
  <article data-timings="">
    <pre><code class="r">x &lt;- xts(3:7, Sys.Date()+3:7)
y &lt;- xts(1:5, Sys.Date()+1:5)

merge.xts(x,y)
</code></pre>

<pre><code>##             x  y
## 2014-08-30 NA  1
## 2014-08-31 NA  2
## 2014-09-01  3  3
## 2014-09-02  4  4
## 2014-09-03  5  5
## 2014-09-04  6 NA
## 2014-09-05  7 NA
</code></pre>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-118" style="background:;">
  <hgroup>
    <h2>練習題11</h2>
  </hgroup>
  <article data-timings="">
    <h3>把<code>關鍵字</code>和<code>股票漲跌</code>依據<code>時間</code>做合併, 表格名稱 : words_tbl_xts, return.status.xts</h3>

<pre><code class="r">final_tbl &lt;- merge.xts( ___ , ___ , fill=0)
names(final_tbl) &lt;- c(dis_words, names(return.status[,-1]))
</code></pre>

<pre><code>##            信義計畫區 ：豪宅交易 25日前提 不變 漲多 漲少 跌多 跌少
## 2014-01-02          0          0        0    1    0    0    0    0
## 2014-01-02          0          0        0    0    0    0    0    0
## 2014-01-02          0          0        0    0    0    0    0    0
## 2014-01-02          0          0        0    0    0    0    0    0
## 2014-01-03          0          0        0    0    0    0    0    1
## 2014-01-03          0          0        0    0    0    0    0    0
</code></pre>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-119" style="background:;">
  <hgroup>
    <h2>解答11</h2>
  </hgroup>
  <article data-timings="">
    <pre><code class="r">final_tbl &lt;- merge.xts(words_tbl_xts, return.status.xts, fill=0)
names(final_tbl) &lt;- c(dis_words, names(return.status[,-1]))
</code></pre>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-120" style="background:;">
  <hgroup>
    <h2>算 彼此之間的相關度</h2>
  </hgroup>
  <article data-timings="">
    <h3>計算 <code>共變異矩陣</code></h3>

<pre><code class="r">tbl_cov &lt;- cov(final_tbl)
</code></pre>

<h3>計算 <code>曼哈頓距離</code></h3>

<pre><code class="r">d &lt;- dist(t(final_tbl),  method = &quot;manhattan&quot;)
d2 &lt;- as.matrix(d) 
</code></pre>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-121" style="background:;">
  <hgroup>
    <h2>和<code>漲跌狀態</code>有關的<code>關鍵字</code></h2>
  </hgroup>
  <article data-timings="">
    
<div style='float:left;width:48%;' class='centered'>
  <h3>和<code>跌多狀態</code>較接近的關鍵字</h3>

<pre><code class="r">score &lt;- sort(d2[,&#39;跌多&#39;])
words &lt;- names(score)
head(data.frame(words), 10)
</code></pre>

<pre><code>##    words
## 1   跌多
## 2   總銷
## 3   直逼
## 4   公園
## 5   招標
## 6   漲逾
## 7   商圈
## 8   標售
## 9   增加
## 10  現身
</code></pre>

</div>
<div style='float:right;width:48%;'>
  <h3>和<code>漲多狀態</code>較接近的關鍵字</h3>

<pre><code class="r">score &lt;- sort(d2[,&#39;漲多&#39;])
words &lt;- names(score)
head(data.frame(words), 10)
</code></pre>

<pre><code>##       words
## 1      漲多
## 2      重劃
## 3      所得
## 4      網路
## 5      最受
## 6      點閱
## 7      推案
## 8    下半年
## 9  房價漲幅
## 10     春節
</code></pre>

</div>
  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-122" style="background:;">
  <hgroup>
    <h2>整理一下 ...</h2>
  </hgroup>
  <article data-timings="">
    <pre><code class="r">kw &lt;- list()
for(col in c(&#39;跌多&#39;,&#39;跌少&#39;,&#39;不變&#39;,&#39;漲少&#39;,&#39;漲多&#39;)){
  kw &lt;- cbind(kw, names(head(sort(d2[,col]), 10)))
}
</code></pre>

<pre><code>##       [,1]   [,2]       [,3]       [,4]   [,5]      
##  [1,] &quot;跌多&quot; &quot;跌少&quot;     &quot;不變&quot;     &quot;漲少&quot; &quot;漲多&quot;    
##  [2,] &quot;總銷&quot; &quot;標脫&quot;     &quot;現身&quot;     &quot;9.4&quot;  &quot;重劃&quot;    
##  [3,] &quot;直逼&quot; &quot;標售&quot;     &quot;置產&quot;     &quot;增加&quot; &quot;所得&quot;    
##  [4,] &quot;公園&quot; &quot;萬華&quot;     &quot;下半年&quot;   &quot;增近&quot; &quot;網路&quot;    
##  [5,] &quot;招標&quot; &quot;新隆國宅&quot; &quot;不動產&quot;   &quot;中和&quot; &quot;最受&quot;    
##  [6,] &quot;漲逾&quot; &quot;直逼&quot;     &quot;打炒房&quot;   &quot;換屋&quot; &quot;點閱&quot;    
##  [7,] &quot;商圈&quot; &quot;招標&quot;     &quot;售屋&quot;     &quot;可以&quot; &quot;推案&quot;    
##  [8,] &quot;標售&quot; &quot;買賣&quot;     &quot;房地產&quot;   &quot;網路&quot; &quot;下半年&quot;  
##  [9,] &quot;增加&quot; &quot;增近&quot;     &quot;合宜住宅&quot; &quot;A25&quot;  &quot;房價漲幅&quot;
## [10,] &quot;現身&quot; &quot;中和&quot;     &quot;漲逾&quot;     &quot;79.&quot;  &quot;春節&quot;
</code></pre>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-123" style="background:;">
  <hgroup>
    <h2>漲跌狀態對應的關鍵字, 出現在哪些新聞標題？ (1/2)</h2>
  </hgroup>
  <article data-timings="">
    <pre><code class="r">index &lt;- str_extract(titles, &quot;重劃|所得&quot;)
titles[!is.na(index)]
</code></pre>

<pre><code>## [1] &quot;政府入駐重劃區房價加分信義計畫區價差55.86%最大&quot;                            
## [2] &quot;北市買房要不吃不喝15年所得逾6成都拿去繳房貸&quot;                               
## [3] &quot;偏愛新北重劃區女性購屋佔5成高出男性48.8%&quot;                                  
## [4] &quot;財長：豪宅交易設算所得比率仍未定2014-01-08財長：豪宅交易設算所得比率仍未定&quot;
## [5] &quot;中市13期重劃第4標動土最後一塊拼圖到位&quot;
</code></pre>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-124" style="background:;">
  <hgroup>
    <h2>漲跌狀態對應的關鍵字, 出現在哪些新聞標題？ (2/2)</h2>
  </hgroup>
  <article data-timings="">
    <pre><code class="r">index &lt;- grepl(&quot;總銷|招標&quot;, titles)
titles[index]
</code></pre>

<pre><code>## [1] &quot;北市銅山街地上權案招標權利金底價6.8億&quot;                                                  
## [2] &quot;施工黑暗期捷運松山線店面仍漲7%最高每坪140萬2014-03-1612宗國有地地上權招標總底價54.7億元&quot;
## [3] &quot;去年全台店面總銷金額破千億北市247.5億居冠&quot;                                              
## [4] &quot;店面熱！全台去年總銷破千億元北市占比達23.2%&quot;                                            
## [5] &quot;台糖招商文山區地上權招標權利金底價2.56億&quot;                                               
## [6] &quot;2013全台店面交易可望破千億北市總銷占22%居冠&quot;                                            
## [7] &quot;北市店面夯去年前三季占全台總銷22%&quot;
</code></pre>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-125" style="background:;">
  <hgroup>
    <h2>練習題12</h2>
  </hgroup>
  <article data-timings="">
    <h3>請利用 grepl 與 &amp; 找出同時出現 &#39;捷運&#39; 與 &#39;房價&#39; 的 titles</h3>

<pre><code class="r">index &lt;- grepl( __ ) &amp; grepl( __ )
titles[index]

</code></pre>

<pre><code>## [1] &quot;板橋捷運宅房價續揚新巨蛋最高每坪79.4萬元&quot;                                                                  
## [2] &quot;雙學區+捷運通車效應敦化國中小學區宅房價年漲15.1%2014-05-18雙學區+捷運通車效應敦化國中小學區宅房價年漲15.1%&quot;
## [3] &quot;捷運松山線年底開通捷運站周邊房價近一年漲14%&quot;
</code></pre>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-126" style="background:;">
  <hgroup>
    <h2>解答12</h2>
  </hgroup>
  <article data-timings="">
    <pre><code class="r">index &lt;- grepl(&quot;捷運&quot;, titles) &amp; grepl(&quot;房價&quot;, titles)
titles[index]

</code></pre>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-127" style="background:;">
  <hgroup>
    <h2>一些後續應用</h2>
  </hgroup>
  <article data-timings="">
    <h3>既然已經整理出表格了, 就可以...</h3>

<h3>拿去跑各種奇奇怪怪的迴歸分析 / 機器學習</h3>

<h3>做降維(mds, pca, svd ...)，然後視覺化</h3>

<h3>以上請期待下一輪 R tutorail</h3>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-128" style="background:;">
  <hgroup>
    <h2>降維視覺化的小範例</h2>
  </hgroup>
  <article data-timings="">
    <pre><code class="r">fit &lt;- cmdscale(d2, eig = TRUE, k=2)
x &lt;- fit$points[,1]
y &lt;- fit$points[,2]
</code></pre>

<pre><code class="r">plot(x, y, xlab=&quot;Coordinate 1&quot;, ylab=&quot;Coordinate 2&quot;, type = &quot;n&quot;)
text(x, y, labels = row.names(t(final_tbl)), cex=.7)
</code></pre>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-129" style="background:;">
  <hgroup>
    <h2>附錄</h2>
  </hgroup>
  <article data-timings="">
    <h3>為前面網頁的下載步驟，使用套件為 <a href="https://github.com/ropensci/RSelenium">RSelenium</a></h3>

<h3>若有安裝問題請看 RSelenium 官網的安裝教學</h3>

<h3>這裡有一些大大們提供的<a href="http://www.meetup.com/Taiwan-R/events/196182542/">問題解決方法</a></h3>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-130" style="background:;">
  <hgroup>
    <h2>打開 phantomjs</h2>
  </hgroup>
  <article data-timings="">
    <pre><code class="r">
pJS &lt;- phantom()
Sys.sleep(5) # give the binary a moment
remDr &lt;- remoteDriver(browserName = &#39;phantomjs&#39;)
remDr$open()

</code></pre>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-131" style="background:;">
  <hgroup>
    <h2>抓 yahoo 房地產新聞 title</h2>
  </hgroup>
  <article data-timings="">
    <h3>open url</h3>

<pre><code class="r">url &lt;- &#39;https://tw.news.yahoo.com/real-estate/archive/1.html&#39;
remDr$navigate(url)
</code></pre>

<h3>parse html</h3>

<pre><code class="r">doc &lt;- remDr$findElements(&quot;xpath&quot;, &quot;//ul/li/div/div/h4/a&quot;)

titles &lt;- sapply(doc, function(doc){
  doc$getElementText()
})

</code></pre>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-132" style="background:;">
  <hgroup>
    <h2>連續抓10頁</h2>
  </hgroup>
  <article data-timings="">
    <pre><code class="r">title &lt;- list()

for(i in 1:10){
  url &lt;- sprintf(&#39;https://tw.news.yahoo.com/real-estate/archive/%d.html&#39;, i)
  remDr$navigate(url)
  doc &lt;- remDr$findElements(&quot;xpath&quot;, &quot;//ul/li/div/div/h4/a&quot;)
  tmp &lt;- sapply(doc, function(doc){
    doc$getElementText()})
  title &lt;- append(title, tmp)
} 
</code></pre>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-133" style="background:;">
  <hgroup>
    <h2>抓 yahoo 搜尋結果</h2>
  </hgroup>
  <article data-timings="">
    <h3>open url</h3>

<pre><code class="r">remDr$navigate(&quot;https://tw.yahoo.com/&quot;)
</code></pre>

<h3>找出搜尋欄</h3>

<pre><code class="r">webElem &lt;- remDr$findElement(using = &quot;id&quot;, &quot;p&quot;)
</code></pre>

<h3>輸入&quot;房價&quot;, 並點擊搜尋</h3>

<pre><code class="r">webElem$sendKeysToElement(list(&quot;房價&quot;, key = &quot;enter&quot;))
</code></pre>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-134" style="background:;">
  <hgroup>
    <h3>抓內容並點擊下一頁</h3>
  </hgroup>
  <article data-timings="">
    <pre><code class="r">search_title &lt;- list()
for(i in 1:10){
  webElems &lt;- remDr$findElements(using = &quot;xpath&quot;, &quot;//li/div/div/h3/a&quot;)
  resHeaders &lt;- unlist(lapply(webElems, function(x){x$getElementText()}))

  search_title &lt;- append(search_title, resHeaders)
  webElems &lt;- remDr$findElement(using = &quot;id&quot;, value = &quot;pg-next&quot;)
  webElems$clickElement()

}

</code></pre>

  </article>
  <!-- Presenter Notes -->
</slide>

    <slide class="backdrop"></slide>
  </slides>
  <div class="pagination pagination-small" id='io2012-ptoc' style="display:none;">
    <ul>
      <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=1 title=''>
         1
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=2 title='結構化資料'>
         2
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=3 title='半結構化資料'>
         3
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=4 title='非結構化資料'>
         4
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=5 title=''>
         5
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=6 title=''>
         6
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=7 title=''>
         7
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=8 title=''>
         8
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=9 title='web scraping'>
         9
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=10 title=''>
         10
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=11 title=''>
         11
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=12 title='CH1 抓取網路資料'>
         12
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=13 title='What is HTML?'>
         13
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=14 title=''>
         14
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=15 title=''>
         15
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=16 title='Document Object Model (DOM)'>
         16
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=17 title='樹狀結構的內容'>
         17
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=18 title='xpath 常用到的操作'>
         18
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=19 title='如果想抓 a 的話'>
         19
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=20 title='如果指定 a 的 attribute 或 text'>
         20
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=21 title='匯入套件'>
         21
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=22 title='開啟下載好的 html 檔案'>
         22
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=23 title='抓出 title和 連結'>
         23
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=24 title=''>
         24
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=25 title='一次抓多篇'>
         25
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=26 title='練習題1'>
         26
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=27 title=''>
         27
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=28 title='解答1'>
         28
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=29 title='(自行操作) 保存/讀取 抓下來的數據'>
         29
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=30 title='匯入這次用的資料'>
         30
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=31 title='CH2 字串處理'>
         31
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=32 title='正規表達 介紹'>
         32
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=33 title=''>
         33
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=34 title=''>
         34
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=35 title='練習題2'>
         35
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=36 title='解答2'>
         36
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=37 title='進階一點的正規表達'>
         37
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=38 title='練習題3'>
         38
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=39 title='解答3'>
         39
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=40 title='清除符號的方法介紹'>
         40
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=41 title='如果想清除中文特殊符號 ...'>
         41
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=42 title=''>
         42
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=43 title='substr 用法'>
         43
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=44 title=''>
         44
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=45 title=''>
         45
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=46 title='練習題4'>
         46
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=47 title='解答4'>
         47
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=48 title=''>
         48
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=49 title=''>
         49
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=50 title=''>
         50
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=51 title='把字段長度1~6都列舉出來，並分別儲存'>
         51
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=52 title=''>
         52
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=53 title=''>
         53
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=54 title=''>
         54
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=55 title=''>
         55
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=56 title=''>
         56
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=57 title=''>
         57
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=58 title=''>
         58
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=59 title=''>
         59
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=60 title=''>
         60
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=61 title=''>
         61
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=62 title='練習題5'>
         62
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=63 title=''>
         63
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=64 title='解答5'>
         64
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=65 title=''>
         65
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=66 title='操作'>
         66
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=67 title='操作'>
         67
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=68 title=''>
         68
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=69 title='paste, grep 用法'>
         69
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=70 title='練習題6'>
         70
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=71 title='解答6'>
         71
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=72 title='挑出單字長度 2~5 的 候選詞彙'>
         72
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=73 title='長度2~5的 單字 出現次數分佈'>
         73
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=74 title='找出 words_2_5 出現次數&gt;2 的詞彙'>
         74
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=75 title='CH3 進行聚合'>
         75
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=76 title='前面 segmentWord 練習題的使用'>
         76
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=77 title='進行計算'>
         77
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=78 title=''>
         78
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=79 title='計算單字左右兩邊可以串接其他單字的程度'>
         79
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=80 title='進行計算'>
         80
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=81 title='單字兩側的混亂程度分佈'>
         81
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=82 title='挑出混亂程度 &gt;1 的字串'>
         82
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=83 title='混亂程度的例子'>
         83
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=84 title=''>
         84
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=85 title=''>
         85
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=86 title=''>
         86
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=87 title='str_count 用法'>
         87
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=88 title='練習題7'>
         88
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=89 title='解答7'>
         89
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=90 title=''>
         90
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=91 title=''>
         91
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=92 title=''>
         92
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=93 title='xts 用法'>
         93
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=94 title='練習題8'>
         94
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=95 title='解答8'>
         95
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=96 title='轉成 xts 格式的好處'>
         96
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=97 title='轉成 xts 格式的好處'>
         97
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=98 title='練習題9'>
         98
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=99 title='解答9'>
         99
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=100 title='CH4 (番外篇) 抓股票找狀態'>
         100
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=101 title='自行操作'>
         101
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=102 title='自行操作'>
         102
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=103 title='自行操作'>
         103
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=104 title='全部平均來看漲幅'>
         104
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=105 title='自行操作'>
         105
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=106 title='自行操作'>
         106
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=107 title='自行操作'>
         107
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=108 title='CH5 表格操作與轉換'>
         108
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=109 title='注意'>
         109
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=110 title='可以合併在一起看 ?'>
         110
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=111 title='可以把<code>5個漲跌狀態</code>變成欄位 ?'>
         111
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=112 title='melt, dcast 用法'>
         112
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=113 title='melt, dcast 用法'>
         113
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=114 title='練習題10'>
         114
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=115 title='解答10'>
         115
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=116 title='將 return.status 轉換成<code>xts</code>格式'>
         116
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=117 title='merge.xts 用法'>
         117
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=118 title='練習題11'>
         118
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=119 title='解答11'>
         119
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=120 title='算 彼此之間的相關度'>
         120
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=121 title='和<code>漲跌狀態</code>有關的<code>關鍵字</code>'>
         121
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=122 title='整理一下 ...'>
         122
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=123 title='漲跌狀態對應的關鍵字, 出現在哪些新聞標題？ (1/2)'>
         123
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=124 title='漲跌狀態對應的關鍵字, 出現在哪些新聞標題？ (2/2)'>
         124
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=125 title='練習題12'>
         125
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=126 title='解答12'>
         126
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=127 title='一些後續應用'>
         127
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=128 title='降維視覺化的小範例'>
         128
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=129 title='附錄'>
         129
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=130 title='打開 phantomjs'>
         130
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=131 title='抓 yahoo 房地產新聞 title'>
         131
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=132 title='連續抓10頁'>
         132
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=133 title='抓 yahoo 搜尋結果'>
         133
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=134 title='抓內容並點擊下一頁'>
         134
      </a>
    </li>
  </ul>
  </div>  <!--[if IE]>
    <script 
      src="http://ajax.googleapis.com/ajax/libs/chrome-frame/1/CFInstall.min.js">  
    </script>
    <script>CFInstall.check({mode: 'overlay'});</script>
  <![endif]-->
</body>
  <!-- Load Javascripts for Widgets -->
  <script src="libraries/widgets/quiz/js/jquery.quiz.js"></script>
<script src="libraries/widgets/quiz/js/mustache.min.js"></script>
<script src="libraries/widgets/quiz/js/quiz-app.js"></script>
<script src="libraries/widgets/bootstrap/js/bootstrap.min.js"></script>
<script src="libraries/widgets/bootstrap/js/bootbox.min.js"></script>

  <!-- MathJax: Fall back to local if CDN offline but local image fonts are not supported (saves >100MB) -->
  <script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      tex2jax: {
        inlineMath: [['$','$'], ['\\(','\\)']],
        processEscapes: true
      }
    });
  </script>
  <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/2.0-latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
  <!-- <script src="https://c328740.ssl.cf1.rackcdn.com/mathjax/2.0-latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
  </script> -->
  <script>window.MathJax || document.write('<script type="text/x-mathjax-config">MathJax.Hub.Config({"HTML-CSS":{imageFont:null}});<\/script><script src="libraries/widgets/mathjax/MathJax.js?config=TeX-AMS-MML_HTMLorMML"><\/script>')
</script>
<script>  
  $(function (){ 
    $("#example").popover(); 
    $("[rel='tooltip']").tooltip(); 
  });  
  </script>  
  <!-- LOAD HIGHLIGHTER JS FILES -->
  <script src="libraries/highlighters/highlight.js/highlight.pack.js"></script>
  <script>hljs.initHighlightingOnLoad();</script>
  <!-- DONE LOADING HIGHLIGHTER JS FILES -->
   
  </html>